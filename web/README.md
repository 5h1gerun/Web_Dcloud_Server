# Web サイト利用ガイド

このディレクトリには、ファイル共有を行う aiohttp 製 Web アプリケーションが含まれています。ここでは Web UI の基本的な使い方を説明します。

## ログイン
1. ブラウザで `https://<サーバーのホスト名>:<PORT>` にアクセスします。
2. ユーザー名とパスワードを入力して「Sign In」をクリックします。
3. 二要素認証 (TOTP) を有効にしている場合は、認証コードの入力画面が表示されます。Authenticator アプリで生成される 6 桁コードを入力してください。
4. PC 版のログインページでは QR コードが表示され、スマホで読み取ると既に認証済みのセッションを利用してログインできます。
5. 環境変数 `FORCE_HTTPS=1` を設定すると、HTTP でアクセスした場合も自動的に HTTPS へリダイレクトされます。

## ファイルのアップロード
- ホーム画面の「ファイルアップロード」セクションから、ファイル選択ボタンでアップロードするか、エリアへドラッグ＆ドロップして追加します。
- 画面下部の進捗バーが 100% になれば完了です。

## ファイル一覧の操作
アップロード済みファイルは一覧表に表示されます。各行で以下の操作が行えます。

| 項目 | 説明 |
| --- | --- |
| ダウンロード | ファイルを直接ダウンロードします |
| 送信 | ファイルを指定したユーザーへ DM で送信します |
| 共有切替 | リンク共有の有効/無効を切り替えます。共有期限を 1 日、1 週間、1 か月、無期限から選択できます |
| 共有リンク | 有効化すると共有 URL が表示され、コピー可能になります |
| タグ | 任意のラベルを入力して検索に利用できます |
| 名前変更 | ファイル名を変更します |
| 削除 | ファイルを削除します |
| 残り期限 | 共有中ファイルの残り公開期間を表示します |

テーブル上部の検索ボックスでは、ファイル名やタグを対象にフィルタリングできます。

ダウンロードリンクには `?preview=1` を付与でき、画像や動画はブラウザ内で直接プレビュー表示されます。

## 共有フォルダ
ナビゲーションの「共有フォルダ」を開くと、他ユーザーと共有可能なフォルダの一覧が表示されます。フォルダを選択すると専用のアップロードフォームとファイル一覧が現れ、ZIP 一括ダウンロードも可能です。


## Google Drive 連携
Google Drive で OAuth 認証を行うと、アップロードしたファイルを Drive に自動でコピーしたり、`/gdrive_import` ページから Drive 上のファイルを取り込むことができます。ファイル名検索や共有リンクの入力にも対応しており、ボタン一つでインポートが完了します。

## オフライン動作と通知
Service Worker により主要な静的ファイルと `/offline` ページがキャッシュされます。オフライン時にページ遷移に失敗すると自動的にオフライン用ページを表示します。また `VAPID_PUBLIC_KEY` を設定することで Push API を利用した通知も受け取れます。

## ログアウト
画面右上の「Logout」をクリックするとログアウトします。

以上が Web UI の基本的な操作方法です。

## スマホ版 UI
スマートフォンからアクセスした場合は自動的にモバイル向けテンプレートを表示します。画面は1カラム構成で、`static/css/style-phone.css` が適用されます。カードは縦長のメモ帳風デザインとなり、ホーム画面から共有フォルダ一覧へ移動するボタンも用意されています。旧来の `/mobile` パスもそのまま利用可能です。さらに PC 版と同等の操作（共有切替、名前変更、タグ編集など）もカード上から実行できます。