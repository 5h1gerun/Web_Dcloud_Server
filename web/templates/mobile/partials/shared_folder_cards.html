{% if files %}
<div class="d-grid gap-2">
  {% for f in files %}
  <div class="card file-card">
    <div class="card-body d-flex align-items-center">
      <div class="me-2">
        {% if f.is_image %}
        <img src="{{ f.preview_url }}" loading="lazy" class="rounded" onerror="previewError(this)">
        {% elif f.is_video %}
        <video src="{{ f.preview_url }}" preload="metadata" class="rounded" muted autoplay loop playsinline></video>
        {% else %}
        <i class="bi {{ icon_by_ext(f.original_name) }} fs-3 text-secondary"></i>
        {% endif %}
      </div>
      <div class="flex-grow-1">
        <div class="file-name small" data-file-id="{{ f.id }}">{{ f.original_name }}</div>
        <div class="text-muted small">{{ f.size|human_size }}</div>
      </div>
      <div class="ms-2 text-nowrap">
        <a href="{{ f.download_url }}" class="btn btn-sm btn-outline-primary"><i class="bi bi-download"></i></a>
        {% if f.user_id == user_id %}
        <form method="post" action="/shared/delete/{{ f.id }}" class="d-inline-block ms-1" onsubmit="return confirm('本当に削除しますか？');">
          <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
          <button type="submit" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
        </form>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<p class="text-center text-muted">このフォルダにはファイルがありません。</p>
{% endif %}
